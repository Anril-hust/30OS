\hypertarget{sheet_8c}{}\section{src/sheet.c File Reference}
\label{sheet_8c}\index{src/sheet.\+c@{src/sheet.\+c}}


basic functions related to sheet.  


{\ttfamily \#include \char`\"{}sheet.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{sheet_8c_a84bc4feeaed8d9ee63caa9ac081b4d90}{sheet\+\_\+init} (uint8 $\ast$res\+Vram)
\begin{DoxyCompactList}\small\item\em init sheet\+Ctl. \end{DoxyCompactList}\item 
void \hyperlink{sheet_8c_a60adeb9ceefccb6371183f12dbcc33ed}{sheet\+\_\+draw\+\_\+all} ()
\begin{DoxyCompactList}\small\item\em refresh the whole screen, redraw all the sheet existed. \end{DoxyCompactList}\item 
void \hyperlink{sheet_8c_aeb623f9ef3418510f8cace8a377a6611}{sheet\+\_\+draw\+\_\+sub} (I\+N int32 top\+Left\+X, I\+N int32 top\+Left\+Y, I\+N int32 bottom\+Right\+X, I\+N int32 bottom\+Right\+Y)
\begin{DoxyCompactList}\small\item\em refresh the given rectangle area, redraw all the sheet if in this area. \end{DoxyCompactList}\item 
void \hyperlink{sheet_8c_abdacf0bce47e8fd4e54bfce39ef6576d}{sheet\+\_\+draw\+\_\+sub\+\_\+without\+Mouse} (I\+N int32 top\+Left\+X, I\+N int32 top\+Left\+Y, I\+N int32 bottom\+Right\+X, I\+N int32 bottom\+Right\+Y)
\begin{DoxyCompactList}\small\item\em refresh the given rectangle area, redraw all the sheet if in this area without sheet which hold mouse. \end{DoxyCompactList}\item 
boolean \hyperlink{sheet_8c_a91b935bbd00dee76f18e37307dbf116b}{sheet\+\_\+add} (I\+N uint8 $\ast$buf, I\+N int32 width, I\+N int32 height, I\+N int32 top\+Left\+X, I\+N int32 top\+Left\+Y, I\+N int8 flags, O\+U\+T \hyperlink{struct_s_h_e_e_t}{S\+H\+E\+E\+T} $\ast$$\ast$sheet)
\begin{DoxyCompactList}\small\item\em create one sheet, add the related value into sheet\+Ctl, You can get the sheet handle from param sheet. \end{DoxyCompactList}\item 
boolean \hyperlink{sheet_8c_a945f67fabfd3cdf76d1403692b6749eb}{sheet\+\_\+add\+\_\+mouse} (I\+N uint8 $\ast$buf, I\+N int32 width, I\+N int32 height, I\+N int32 top\+Left\+X, I\+N int32 top\+Left\+Y, I\+N int8 flags, O\+U\+T \hyperlink{struct_s_h_e_e_t}{S\+H\+E\+E\+T} $\ast$$\ast$sheet)
\begin{DoxyCompactList}\small\item\em add the mouse into sheet\+Ctl, You can get the sheet handle from param sheet. \end{DoxyCompactList}\item 
boolean \hyperlink{sheet_8c_ac54d19422d9a8fc6ee0ac68b18d23664}{sheet\+\_\+del} (I\+N \hyperlink{struct_s_h_e_e_t}{S\+H\+E\+E\+T} $\ast$sheet)
\begin{DoxyCompactList}\small\item\em delete on sheet from sheet\+Ctl. \end{DoxyCompactList}\item 
void \hyperlink{sheet_8c_aac62e7c10483a2de006e8aaaaf32cab3}{sheet\+\_\+sort} ()
\begin{DoxyCompactList}\small\item\em sort the sheet acccording to their Zvalue, z describe the layer of the sheet. \end{DoxyCompactList}\item 
boolean \hyperlink{sheet_8c_a6e435a2b89c42cc84bdc967e21f2d3ac}{sheet\+\_\+pin\+\_\+top} (I\+N \hyperlink{struct_s_h_e_e_t}{S\+H\+E\+E\+T} $\ast$sheet)
\begin{DoxyCompactList}\small\item\em put the given sheet on the top layer. \end{DoxyCompactList}\item 
boolean \hyperlink{sheet_8c_af4aa5d69cd5cf898b9a6430ca682c06d}{sheet\+\_\+add\+\_\+redraw\+\_\+region} (I\+N int32 top\+Left\+X, I\+N int32 top\+Left\+Y, I\+N int32 bottom\+Right\+X, I\+N int32 bottom\+Right\+Y)
\begin{DoxyCompactList}\small\item\em add the redraw request. \end{DoxyCompactList}\item 
boolean \hyperlink{sheet_8c_aac86a946b96df88ab655ec74a8fc4aa3}{sheet\+\_\+add\+\_\+redraw\+\_\+region\+\_\+rect} (I\+N \hyperlink{struct_r_e_c_t}{R\+E\+C\+T} rect)
\begin{DoxyCompactList}\small\item\em add the redraw request. \end{DoxyCompactList}\item 
void \hyperlink{sheet_8c_aec5e44c6cc2a850fd38a903e5d2abcb5}{sheet\+\_\+draw\+\_\+deamon} ()
\begin{DoxyCompactList}\small\item\em the redraw daemon. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{sheet_8c_a8fa9be897b3aa6ac0515ac063fd155ce}{}\hyperlink{struct_s_h_e_e_t___c_t_l}{S\+H\+E\+E\+T\+\_\+\+C\+T\+L} \hyperlink{sheet_8c_a8fa9be897b3aa6ac0515ac063fd155ce}{sheet\+Ctl}\label{sheet_8c_a8fa9be897b3aa6ac0515ac063fd155ce}

\begin{DoxyCompactList}\small\item\em The Struct contain all the sheets. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
basic functions related to sheet. 

All drawing action operate on sheet. The sheet is similiar to Layer. It can hold pixels. All movement of action also based on sheet, The sheet is managed by \hyperlink{struct_s_h_e_e_t___c_t_l}{S\+H\+E\+E\+T\+\_\+\+C\+T\+L}. These file contains some utils functions used to operate the sheet. There are two ways to redraw the screen. 1st, directly call \hyperlink{sheet_8c_aeb623f9ef3418510f8cace8a377a6611}{sheet\+\_\+draw\+\_\+sub()}, \hyperlink{sheet_8c_a60adeb9ceefccb6371183f12dbcc33ed}{sheet\+\_\+draw\+\_\+all()} or \hyperlink{sheet_8c_abdacf0bce47e8fd4e54bfce39ef6576d}{sheet\+\_\+draw\+\_\+sub\+\_\+without\+Mouse()}. That would be redrawn immediately. 2nd, call \hyperlink{sheet_8c_aac86a946b96df88ab655ec74a8fc4aa3}{sheet\+\_\+add\+\_\+redraw\+\_\+region\+\_\+rect()} or \hyperlink{sheet_8c_af4aa5d69cd5cf898b9a6430ca682c06d}{sheet\+\_\+add\+\_\+redraw\+\_\+region()} to add redraw request. That would be redrawn by sheet\+\_\+daemon when C\+P\+U is idle. 

\subsection{Function Documentation}
\hypertarget{sheet_8c_a91b935bbd00dee76f18e37307dbf116b}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+add@{sheet\+\_\+add}}
\index{sheet\+\_\+add@{sheet\+\_\+add}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+add}]{\setlength{\rightskip}{0pt plus 5cm}boolean sheet\+\_\+add (
\begin{DoxyParamCaption}
\item[{I\+N uint8 $\ast$}]{buf, }
\item[{I\+N int32}]{width, }
\item[{I\+N int32}]{height, }
\item[{I\+N int32}]{top\+Left\+X, }
\item[{I\+N int32}]{top\+Left\+Y, }
\item[{I\+N int8}]{flags, }
\item[{O\+U\+T {\bf S\+H\+E\+E\+T} $\ast$$\ast$}]{sheet}
\end{DoxyParamCaption}
)}\label{sheet_8c_a91b935bbd00dee76f18e37307dbf116b}


create one sheet, add the related value into sheet\+Ctl, You can get the sheet handle from param sheet. 

Create one sheet with given buffer, area, flag and get the sheet handle with sheet. The sheet would be placed on the top layer. 
\begin{DoxyParams}{Parameters}
{\em buf} & the buffer to copy into the sheet. \\
\hline
{\em width} & width of the area. \\
\hline
{\em height} & height of the area. \\
\hline
{\em top\+Left\+X} & x value of top left pos of the area. \\
\hline
{\em top\+Left\+Y} & y value of top left pos of the area. \\
\hline
{\em flags} & currently, it specify the transparency color number of this sheet. \\
\hline
{\em sheet} & the sheet handle returned. Save it for future use. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
whether add operation is successful, if yes return T\+R\+U\+E else F\+A\+L\+S\+E. 
\end{DoxyReturn}
\hypertarget{sheet_8c_a945f67fabfd3cdf76d1403692b6749eb}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+add\+\_\+mouse@{sheet\+\_\+add\+\_\+mouse}}
\index{sheet\+\_\+add\+\_\+mouse@{sheet\+\_\+add\+\_\+mouse}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+add\+\_\+mouse}]{\setlength{\rightskip}{0pt plus 5cm}boolean sheet\+\_\+add\+\_\+mouse (
\begin{DoxyParamCaption}
\item[{I\+N uint8 $\ast$}]{buf, }
\item[{I\+N int32}]{width, }
\item[{I\+N int32}]{height, }
\item[{I\+N int32}]{top\+Left\+X, }
\item[{I\+N int32}]{top\+Left\+Y, }
\item[{I\+N int8}]{flags, }
\item[{O\+U\+T {\bf S\+H\+E\+E\+T} $\ast$$\ast$}]{sheet}
\end{DoxyParamCaption}
)}\label{sheet_8c_a945f67fabfd3cdf76d1403692b6749eb}


add the mouse into sheet\+Ctl, You can get the sheet handle from param sheet. 

Create one sheet with given mouse buffer, area, flag and get the sheet handle with sheet. 
\begin{DoxyParams}{Parameters}
{\em buf} & the buffer to copy into the sheet, the buffer have to be pixels of mouse. \\
\hline
{\em width} & width of the area. \\
\hline
{\em height} & height of the area. \\
\hline
{\em top\+Left\+X} & x value of top left pos of the area. \\
\hline
{\em top\+Left\+Y} & y value of top left pos of the area. \\
\hline
{\em flags} & currently, it specify the transparency color number of this sheet. \\
\hline
{\em sheet} & the sheet handle returned. Save it for future use. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
whether add operation is successful, if yes return T\+R\+U\+E else F\+A\+L\+S\+E. 
\end{DoxyReturn}
\hypertarget{sheet_8c_af4aa5d69cd5cf898b9a6430ca682c06d}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+add\+\_\+redraw\+\_\+region@{sheet\+\_\+add\+\_\+redraw\+\_\+region}}
\index{sheet\+\_\+add\+\_\+redraw\+\_\+region@{sheet\+\_\+add\+\_\+redraw\+\_\+region}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+add\+\_\+redraw\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}boolean sheet\+\_\+add\+\_\+redraw\+\_\+region (
\begin{DoxyParamCaption}
\item[{I\+N int32}]{top\+Left\+X, }
\item[{I\+N int32}]{top\+Left\+Y, }
\item[{I\+N int32}]{bottom\+Right\+X, }
\item[{I\+N int32}]{bottom\+Right\+Y}
\end{DoxyParamCaption}
)}\label{sheet_8c_af4aa5d69cd5cf898b9a6430ca682c06d}


add the redraw request. 


\begin{DoxyParams}{Parameters}
{\em top\+Left\+X} & x value of top left pos of the area. \\
\hline
{\em top\+Left\+Y} & y value of top left pos of the area. \\
\hline
{\em bottom\+Right\+X} & x value of bottom right pos of the area. \\
\hline
{\em bottom\+Right\+Y} & y value of bottom right pos of the area. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
whether add operation is successful, always return T\+R\+U\+E. 
\end{DoxyReturn}
\hypertarget{sheet_8c_aac86a946b96df88ab655ec74a8fc4aa3}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+add\+\_\+redraw\+\_\+region\+\_\+rect@{sheet\+\_\+add\+\_\+redraw\+\_\+region\+\_\+rect}}
\index{sheet\+\_\+add\+\_\+redraw\+\_\+region\+\_\+rect@{sheet\+\_\+add\+\_\+redraw\+\_\+region\+\_\+rect}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+add\+\_\+redraw\+\_\+region\+\_\+rect}]{\setlength{\rightskip}{0pt plus 5cm}boolean sheet\+\_\+add\+\_\+redraw\+\_\+region\+\_\+rect (
\begin{DoxyParamCaption}
\item[{I\+N {\bf R\+E\+C\+T}}]{rect}
\end{DoxyParamCaption}
)}\label{sheet_8c_aac86a946b96df88ab655ec74a8fc4aa3}


add the redraw request. 

This function is a wraper of \hyperlink{sheet_8c_af4aa5d69cd5cf898b9a6430ca682c06d}{sheet\+\_\+add\+\_\+redraw\+\_\+region()}. 
\begin{DoxyParams}{Parameters}
{\em rect} & the area need redrawn. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
whether add operation is successful, always return T\+R\+U\+E. 
\end{DoxyReturn}
\hypertarget{sheet_8c_ac54d19422d9a8fc6ee0ac68b18d23664}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+del@{sheet\+\_\+del}}
\index{sheet\+\_\+del@{sheet\+\_\+del}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+del}]{\setlength{\rightskip}{0pt plus 5cm}boolean sheet\+\_\+del (
\begin{DoxyParamCaption}
\item[{I\+N {\bf S\+H\+E\+E\+T} $\ast$}]{sheet}
\end{DoxyParamCaption}
)}\label{sheet_8c_ac54d19422d9a8fc6ee0ac68b18d23664}


delete on sheet from sheet\+Ctl. 


\begin{DoxyParams}{Parameters}
{\em sheet} & the sheet to be removed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
whether add operation is successful, if yes return T\+R\+U\+E else F\+A\+L\+S\+E. 
\end{DoxyReturn}
\hypertarget{sheet_8c_a60adeb9ceefccb6371183f12dbcc33ed}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+draw\+\_\+all@{sheet\+\_\+draw\+\_\+all}}
\index{sheet\+\_\+draw\+\_\+all@{sheet\+\_\+draw\+\_\+all}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+draw\+\_\+all}]{\setlength{\rightskip}{0pt plus 5cm}void sheet\+\_\+draw\+\_\+all (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{sheet_8c_a60adeb9ceefccb6371183f12dbcc33ed}


refresh the whole screen, redraw all the sheet existed. 

The function is inefficiency. So, It only be called when necessary. 
\begin{DoxyParams}{Parameters}
{\em N\+U\+L\+L} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+U\+L\+L 
\end{DoxyReturn}
\hypertarget{sheet_8c_aec5e44c6cc2a850fd38a903e5d2abcb5}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+draw\+\_\+deamon@{sheet\+\_\+draw\+\_\+deamon}}
\index{sheet\+\_\+draw\+\_\+deamon@{sheet\+\_\+draw\+\_\+deamon}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+draw\+\_\+deamon}]{\setlength{\rightskip}{0pt plus 5cm}void sheet\+\_\+draw\+\_\+deamon (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{sheet_8c_aec5e44c6cc2a850fd38a903e5d2abcb5}


the redraw daemon. 

It will test if the area is not empty. If the area existed. It will redraw the area. 
\begin{DoxyParams}{Parameters}
{\em N\+U\+L\+L.} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+U\+L\+L. 
\end{DoxyReturn}
\hypertarget{sheet_8c_aeb623f9ef3418510f8cace8a377a6611}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+draw\+\_\+sub@{sheet\+\_\+draw\+\_\+sub}}
\index{sheet\+\_\+draw\+\_\+sub@{sheet\+\_\+draw\+\_\+sub}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+draw\+\_\+sub}]{\setlength{\rightskip}{0pt plus 5cm}void sheet\+\_\+draw\+\_\+sub (
\begin{DoxyParamCaption}
\item[{I\+N int32}]{top\+Left\+X, }
\item[{I\+N int32}]{top\+Left\+Y, }
\item[{I\+N int32}]{bottom\+Right\+X, }
\item[{I\+N int32}]{bottom\+Right\+Y}
\end{DoxyParamCaption}
)}\label{sheet_8c_aeb623f9ef3418510f8cace8a377a6611}


refresh the given rectangle area, redraw all the sheet if in this area. 

The function is usually called when do refresh. The sheet including sheet which hold mouse. 
\begin{DoxyParams}{Parameters}
{\em top\+Left\+X} & x value of top left pos of the area. \\
\hline
{\em top\+Left\+Y} & y value of top left pos of the area. \\
\hline
{\em bottom\+Right\+X} & x value of bottom right pos of the area. \\
\hline
{\em bottom\+Right\+Y} & y value of bottom right pos of the area. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+U\+L\+L 
\end{DoxyReturn}
\hypertarget{sheet_8c_abdacf0bce47e8fd4e54bfce39ef6576d}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+draw\+\_\+sub\+\_\+without\+Mouse@{sheet\+\_\+draw\+\_\+sub\+\_\+without\+Mouse}}
\index{sheet\+\_\+draw\+\_\+sub\+\_\+without\+Mouse@{sheet\+\_\+draw\+\_\+sub\+\_\+without\+Mouse}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+draw\+\_\+sub\+\_\+without\+Mouse}]{\setlength{\rightskip}{0pt plus 5cm}void sheet\+\_\+draw\+\_\+sub\+\_\+without\+Mouse (
\begin{DoxyParamCaption}
\item[{I\+N int32}]{top\+Left\+X, }
\item[{I\+N int32}]{top\+Left\+Y, }
\item[{I\+N int32}]{bottom\+Right\+X, }
\item[{I\+N int32}]{bottom\+Right\+Y}
\end{DoxyParamCaption}
)}\label{sheet_8c_abdacf0bce47e8fd4e54bfce39ef6576d}


refresh the given rectangle area, redraw all the sheet if in this area without sheet which hold mouse. 

The function is usually called when do refresh. 
\begin{DoxyParams}{Parameters}
{\em top\+Left\+X} & x value of top left pos of the area. \\
\hline
{\em top\+Left\+Y} & y value of top left pos of the area. \\
\hline
{\em bottom\+Right\+X} & x value of bottom right pos of the area. \\
\hline
{\em bottom\+Right\+Y} & y value of bottom right pos of the area. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+U\+L\+L 
\end{DoxyReturn}
\hypertarget{sheet_8c_a84bc4feeaed8d9ee63caa9ac081b4d90}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+init@{sheet\+\_\+init}}
\index{sheet\+\_\+init@{sheet\+\_\+init}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+init}]{\setlength{\rightskip}{0pt plus 5cm}void sheet\+\_\+init (
\begin{DoxyParamCaption}
\item[{uint8 $\ast$}]{res\+Vram}
\end{DoxyParamCaption}
)}\label{sheet_8c_a84bc4feeaed8d9ee63caa9ac081b4d90}


init sheet\+Ctl. 

Called by O\+S to initialize sheet module, double buffer scheme is used to assure anti-\/shake. 
\begin{DoxyParams}{Parameters}
{\em res\+Vram} & the address of reserved video ram. It is used to accomplish double buffer scheme. First draw everything on res\+Vram, then draw res\+Vram to the real video ram. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+U\+L\+L 
\end{DoxyReturn}
\hypertarget{sheet_8c_a6e435a2b89c42cc84bdc967e21f2d3ac}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+pin\+\_\+top@{sheet\+\_\+pin\+\_\+top}}
\index{sheet\+\_\+pin\+\_\+top@{sheet\+\_\+pin\+\_\+top}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+pin\+\_\+top}]{\setlength{\rightskip}{0pt plus 5cm}boolean sheet\+\_\+pin\+\_\+top (
\begin{DoxyParamCaption}
\item[{I\+N {\bf S\+H\+E\+E\+T} $\ast$}]{sheet}
\end{DoxyParamCaption}
)}\label{sheet_8c_a6e435a2b89c42cc84bdc967e21f2d3ac}


put the given sheet on the top layer. 


\begin{DoxyParams}{Parameters}
{\em sheet} & the sheet to be operated. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
whether add operation is successful, if yes return T\+R\+U\+E else F\+A\+L\+S\+E. 
\end{DoxyReturn}
\hypertarget{sheet_8c_aac62e7c10483a2de006e8aaaaf32cab3}{}\index{sheet.\+c@{sheet.\+c}!sheet\+\_\+sort@{sheet\+\_\+sort}}
\index{sheet\+\_\+sort@{sheet\+\_\+sort}!sheet.\+c@{sheet.\+c}}
\subsubsection[{sheet\+\_\+sort}]{\setlength{\rightskip}{0pt plus 5cm}void sheet\+\_\+sort (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{sheet_8c_aac62e7c10483a2de006e8aaaaf32cab3}


sort the sheet acccording to their Zvalue, z describe the layer of the sheet. 


\begin{DoxyParams}{Parameters}
{\em N\+U\+L\+L} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+U\+L\+L 
\end{DoxyReturn}
